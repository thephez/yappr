{
  "like": {
    "type": "object",
    "indices": [
      {
        "name": "postAndOwner",
        "unique": true,
        "properties": [
          {
            "postId": "asc"
          },
          {
            "$ownerId": "asc"
          }
        ]
      },
      {
        "name": "ownerLikes",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "postLikes",
        "properties": [
          {
            "postId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "postId"
    ],
    "properties": {
      "postId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "ID of the liked post",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A like on a post",
    "additionalProperties": false
  },
  "list": {
    "type": "object",
    "indices": [
      {
        "name": "ownerLists",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "name"
    ],
    "properties": {
      "name": {
        "type": "string",
        "position": 0,
        "maxLength": 50,
        "minLength": 1,
        "description": "Name of the list"
      },
      "private": {
        "type": "boolean",
        "position": 2,
        "description": "Whether the list is private"
      },
      "description": {
        "type": "string",
        "position": 1,
        "maxLength": 160,
        "description": "Description of the list"
      }
    },
    "description": "A user-created list",
    "additionalProperties": false
  },
  "mute": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndMuted",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "mutedId": "asc"
          }
        ]
      },
      {
        "name": "ownerMutes",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "mutedId"
    ],
    "properties": {
      "mutedId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the muted user",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "untilTimestamp": {
        "type": "integer",
        "minimum": 0,
        "position": 1,
        "description": "Unix timestamp when mute expires (optional)"
      }
    },
    "description": "A mute relationship",
    "additionalProperties": false
  },
  "post": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndTime",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "timeline",
        "properties": [
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "replyToPost",
        "properties": [
          {
            "replyToPostId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "content"
    ],
    "properties": {
      "content": {
        "type": "string",
        "position": 0,
        "maxLength": 500,
        "minLength": 1,
        "description": "Post content (public content or teaser for private posts)"
      },
      "mediaUrl": {
        "type": "string",
        "pattern": "^https?://.+$",
        "position": 1,
        "maxLength": 512,
        "description": "URL to media file (temporary field - will support multiple media in future)"
      },
      "replyToPostId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 2,
        "byteArray": true,
        "description": "ID of post this is replying to",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "quotedPostId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 3,
        "byteArray": true,
        "description": "ID of quoted post",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "firstMentionId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 4,
        "byteArray": true,
        "description": "First mentioned user ID (temporary field - will support multiple mentions in future)",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "primaryHashtag": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9_]{1,100}$",
        "position": 5,
        "maxLength": 100,
        "description": "Primary hashtag for the post (temporary field - will support multiple hashtags in future)"
      },
      "language": {
        "type": "string",
        "pattern": "^[a-z]{2}$",
        "position": 6,
        "maxLength": 2,
        "description": "Language code of the post"
      },
      "sensitive": {
        "type": "boolean",
        "position": 7,
        "description": "Whether post contains sensitive content"
      },
      "encryptedContent": {
        "type": "array",
        "maxItems": 1024,
        "minItems": 1,
        "position": 8,
        "byteArray": true,
        "description": "Encrypted private post content (AEAD ciphertext). Presence indicates private post."
      },
      "epoch": {
        "type": "integer",
        "minimum": 1,
        "maximum": 4294967295,
        "position": 9,
        "description": "Epoch number for private post key derivation"
      },
      "nonce": {
        "type": "array",
        "maxItems": 24,
        "minItems": 24,
        "position": 10,
        "byteArray": true,
        "description": "24-byte nonce for XChaCha20-Poly1305 encryption"
      }
    },
    "description": "A post/tweet in the social network",
    "additionalProperties": false
  },
  "block": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndBlocked",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "blockedId": "asc"
          }
        ]
      },
      {
        "name": "ownerBlocks",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "blockedId"
    ],
    "properties": {
      "blockedId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the blocked user",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A block relationship",
    "additionalProperties": false
  },
  "avatar": {
    "type": "object",
    "indices": [
      {
        "name": "owner",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          }
        ]
      },
      {
        "name": "updatedAt",
        "properties": [
          {
            "$updatedAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$updatedAt",
      "version",
      "data"
    ],
    "properties": {
      "data": {
        "type": "string",
        "position": 1,
        "maxLength": 128,
        "minLength": 16,
        "description": "Encoded avatar feature data"
      },
      "style": {
        "enum": [
          "realistic",
          "cartoon",
          "anime",
          "pixel"
        ],
        "type": "string",
        "position": 2,
        "description": "Rendering style for the avatar"
      },
      "version": {
        "type": "integer",
        "maximum": 10,
        "minimum": 1,
        "position": 0,
        "description": "Avatar format version"
      }
    },
    "description": "User avatar customization data",
    "additionalProperties": false
  },
  "follow": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndFollowing",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "followingId": "asc"
          }
        ]
      },
      {
        "name": "following",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "followers",
        "properties": [
          {
            "followingId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "followingId"
    ],
    "properties": {
      "followingId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the user being followed",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A follow relationship between users",
    "additionalProperties": false
  },
  "repost": {
    "type": "object",
    "indices": [
      {
        "name": "postAndOwner",
        "unique": true,
        "properties": [
          {
            "postId": "asc"
          },
          {
            "$ownerId": "asc"
          }
        ]
      },
      {
        "name": "ownerReposts",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "postReposts",
        "properties": [
          {
            "postId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "postId"
    ],
    "properties": {
      "postId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "ID of the reposted post",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A repost/retweet of a post",
    "additionalProperties": false
  },
  "profile": {
    "type": "object",
    "indices": [
      {
        "name": "owner",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          }
        ]
      },
      {
        "name": "createdAt",
        "properties": [
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "displayName"
    ],
    "properties": {
      "bio": {
        "type": "string",
        "position": 1,
        "maxLength": 160,
        "description": "User biography"
      },
      "website": {
        "type": "string",
        "pattern": "^https?://.+$",
        "position": 4,
        "maxLength": 100,
        "description": "User's website"
      },
      "avatarId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 2,
        "byteArray": true,
        "description": "Reference to the user's avatar document",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "location": {
        "type": "string",
        "position": 5,
        "maxLength": 50,
        "description": "User location"
      },
      "bannerUrl": {
        "type": "string",
        "pattern": "^https?://.+$",
        "position": 3,
        "maxLength": 512,
        "description": "URL to profile banner image"
      },
      "displayName": {
        "type": "string",
        "position": 0,
        "maxLength": 50,
        "minLength": 1,
        "description": "Display name shown on profile"
      }
    },
    "description": "User profile information",
    "additionalProperties": false
  },
  "bookmark": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndPost",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "postId": "asc"
          }
        ]
      },
      {
        "name": "ownerBookmarks",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "postId"
    ],
    "properties": {
      "postId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "ID of the bookmarked post",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A bookmarked post",
    "additionalProperties": false
  },
  "listMember": {
    "type": "object",
    "indices": [
      {
        "name": "listAndMember",
        "unique": true,
        "properties": [
          {
            "listId": "asc"
          },
          {
            "memberId": "asc"
          }
        ]
      },
      {
        "name": "listMembers",
        "properties": [
          {
            "listId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "listId",
      "memberId"
    ],
    "properties": {
      "listId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "ID of the list",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "memberId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 1,
        "byteArray": true,
        "description": "Identity ID of the list member",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A member of a list",
    "additionalProperties": false
  },
  "notification": {
    "type": "object",
    "indices": [
      {
        "name": "ownerNotifications",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "unreadNotifications",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "read": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "type",
      "fromUserId"
    ],
    "properties": {
      "read": {
        "type": "boolean",
        "position": 3,
        "description": "Whether the notification has been read"
      },
      "type": {
        "enum": [
          "like",
          "repost",
          "follow",
          "reply",
          "mention",
          "quote",
          "privateFeedRequest",
          "privateFeedApproved",
          "privateFeedRevoked"
        ],
        "type": "string",
        "position": 0,
        "description": "Type of notification"
      },
      "postId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 2,
        "byteArray": true,
        "description": "Related post ID (if applicable)",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "fromUserId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 1,
        "byteArray": true,
        "description": "Identity ID of the user who triggered the notification",
        "contentMediaType": "application/x.dash.dpp.identifier"
      }
    },
    "description": "A notification for a user",
    "additionalProperties": false
  },
  "directMessage": {
    "type": "object",
    "indices": [
      {
        "name": "conversation",
        "properties": [
          {
            "conversationId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      },
      {
        "name": "senderMessages",
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "recipientId",
      "conversationId",
      "encryptedContent"
    ],
    "properties": {
      "read": {
        "type": "boolean",
        "position": 3,
        "description": "Whether the message has been read"
      },
      "recipientId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the recipient",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "conversationId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 1,
        "byteArray": true,
        "description": "Unique conversation ID",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "encryptedContent": {
        "type": "string",
        "position": 2,
        "maxLength": 2048,
        "description": "Encrypted message content"
      }
    },
    "description": "A direct message between users",
    "additionalProperties": false
  },
  "followRequest": {
    "type": "object",
    "indices": [
      {
        "name": "targetAndRequester",
        "unique": true,
        "properties": [
          {
            "targetId": "asc"
          },
          {
            "$ownerId": "asc"
          }
        ]
      },
      {
        "name": "target",
        "properties": [
          {
            "targetId": "asc"
          },
          {
            "$createdAt": "asc"
          }
        ]
      }
    ],
    "required": [
      "$createdAt",
      "targetId"
    ],
    "properties": {
      "targetId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the private feed owner being requested",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "publicKey": {
        "type": "array",
        "maxItems": 33,
        "minItems": 33,
        "position": 1,
        "byteArray": true,
        "description": "Requester's secp256k1 public key (compressed, 33 bytes) - required if only hash160 on-chain"
      }
    },
    "description": "A request to follow a user's private feed",
    "additionalProperties": false
  },
  "privateFeedGrant": {
    "type": "object",
    "indices": [
      {
        "name": "ownerAndRecipient",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "recipientId": "asc"
          }
        ]
      },
      {
        "name": "ownerAndLeaf",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "leafIndex": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "recipientId",
      "leafIndex",
      "epoch",
      "encryptedPayload"
    ],
    "properties": {
      "recipientId": {
        "type": "array",
        "maxItems": 32,
        "minItems": 32,
        "position": 0,
        "byteArray": true,
        "description": "Identity ID of the approved private follower",
        "contentMediaType": "application/x.dash.dpp.identifier"
      },
      "leafIndex": {
        "type": "integer",
        "minimum": 0,
        "maximum": 65535,
        "position": 1,
        "description": "Assigned leaf index in the key tree (0-1023 for 1024-leaf tree)"
      },
      "epoch": {
        "type": "integer",
        "minimum": 1,
        "maximum": 4294967295,
        "position": 2,
        "description": "Epoch at time of grant"
      },
      "encryptedPayload": {
        "type": "array",
        "maxItems": 600,
        "minItems": 1,
        "position": 3,
        "byteArray": true,
        "description": "ECIES-encrypted payload containing path keys and current CEK (~485 bytes)"
      }
    },
    "description": "A grant giving a user access to decrypt private feed posts",
    "additionalProperties": false
  },
  "privateFeedRekey": {
    "type": "object",
    "canBeDeleted": false,
    "indices": [
      {
        "name": "ownerAndEpoch",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          },
          {
            "epoch": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "epoch",
      "revokedLeaf",
      "packets",
      "encryptedCEK"
    ],
    "properties": {
      "epoch": {
        "type": "integer",
        "minimum": 2,
        "maximum": 4294967295,
        "position": 0,
        "description": "New epoch number after this rekey (starts at 2 for first revocation)"
      },
      "revokedLeaf": {
        "type": "integer",
        "minimum": 0,
        "maximum": 65535,
        "position": 1,
        "description": "Leaf index that was revoked"
      },
      "packets": {
        "type": "array",
        "maxItems": 2048,
        "minItems": 1,
        "position": 2,
        "byteArray": true,
        "description": "Binary-encoded rekey packets for LKH key update (~1.2KB typical)"
      },
      "encryptedCEK": {
        "type": "array",
        "maxItems": 48,
        "minItems": 48,
        "position": 3,
        "byteArray": true,
        "description": "CEK[epoch] encrypted under new root key (32 bytes + 16 byte auth tag)"
      }
    },
    "description": "A rekey document created when revoking a private feed follower. IMMUTABLE - cannot be deleted.",
    "additionalProperties": false
  },
  "privateFeedState": {
    "type": "object",
    "canBeDeleted": false,
    "indices": [
      {
        "name": "owner",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "treeCapacity",
      "maxEpoch",
      "encryptedSeed"
    ],
    "properties": {
      "treeCapacity": {
        "type": "integer",
        "minimum": 1,
        "maximum": 65535,
        "position": 0,
        "description": "Key tree capacity (typically 1024 for 1024 max private followers)"
      },
      "maxEpoch": {
        "type": "integer",
        "minimum": 1,
        "maximum": 4294967295,
        "position": 1,
        "description": "Maximum pre-generated epoch chain length (typically 2000)"
      },
      "encryptedSeed": {
        "type": "array",
        "maxItems": 256,
        "minItems": 1,
        "position": 2,
        "byteArray": true,
        "description": "ECIES-encrypted feed seed (33 byte ephemeral pubkey + encrypted payload)"
      }
    },
    "description": "Private feed state document created when enabling a private feed. IMMUTABLE - cannot be deleted.",
    "additionalProperties": false
  }
}
