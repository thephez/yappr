{
  "encryptedKeyBackup": {
    "type": "object",
    "indices": [
      {
        "name": "owner",
        "unique": true,
        "properties": [
          {
            "$ownerId": "asc"
          }
        ]
      }
    ],
    "mutable": false,
    "required": [
      "$createdAt",
      "encryptedKey",
      "iv",
      "version",
      "kdfIterations"
    ],
    "properties": {
      "encryptedKey": {
        "type": "string",
        "position": 0,
        "maxLength": 512,
        "minLength": 64,
        "description": "Base64-encoded AES-GCM encrypted private key"
      },
      "iv": {
        "type": "string",
        "position": 1,
        "maxLength": 32,
        "minLength": 16,
        "description": "Base64-encoded initialization vector"
      },
      "version": {
        "type": "integer",
        "position": 2,
        "minimum": 1,
        "maximum": 10,
        "description": "Encryption scheme version for future upgrades"
      },
      "kdfIterations": {
        "type": "integer",
        "position": 3,
        "minimum": 1000000,
        "maximum": 1000000000,
        "description": "PBKDF2 iteration count used for key derivation"
      }
    },
    "description": "Encrypted private key backup for password-based login. Salt derived from $ownerId.",
    "additionalProperties": false
  }
}
